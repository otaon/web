---
title: "Go言語入門(定数)"
date:    2019-04-13T13:00:00+09:00
lastmod: 2019-04-13T13:00:00+09:00
draft: false
toc: true
tags: ["Go", "Golang"]
categories: ["Go"]
authors:
- otaon
---

# 目的
Go言語の基本構文を残す。

# 参考文献
- [スターティング Go言語](https://www.shoeisha.co.jp/book/detail/9784798142418)

# 基本構文
## 定数
Goでは`const`を使用して定数を定義できる。

```go
const X = 1	// 定数1(整数)
```

複数の定数をまとめて定義することもできる。

```go
const (
	X = 1
	Y = 2
	Z = 3
)
```

- **NOTE**  
  - 途中から定数に定義する値を省略した場合、前回定義したのと同じ値を定数定義する。  
    ただし、全ての定数定義の値を省略することはできない。
  - 定数の値の定義には任意の式を使用でき、さらに、その中に他の定数を使用できる。

```go
const (
	X = 1
	Y = 2
	Z	// 2
)

// コンパイルエラー
const (
	X
	Y
	Z
)

const (
	A = 1	// 1
	B = A + 1	// 2
	C = B + 1	// 3
	Z = X + Y	// 9 この行の後に定義されている定数も使用可能
	X = 2
	Y = 7
)
```

### 定数の型
Goの定数定義では、下記のいずれかの値を定義できる。

- 論理型
- 整数(**「整数」であり、int等の型ではない**)
- 浮動小数点数(**「浮動小数点数」であり、float64等の型ではない**)
- 複素数
- ルーン
- 文字列

型を指定子ない定数定義では、整数はあくまでも整数であり、intやuintなどの区別はない。  
型ありの定数を定義したい場合は、下記のように型を指定して定数定義する。

```go
const (
	I64 int64 = -1	// 定数I64はint64型
	I32 = int32(-1)	// 定数32はint32型
	F64 float64 = 1.2	// 定数F64はfloat64型
	F32 = float32(1.2)	// 定数F32はfloat32型
)
```

### 各定数の注意
#### 論理値の定数
論理値はbool型と全く同じであるため、使用上の注意は特に無し。

#### 整数値の定数
整数値の定数には最大値/最小値がないため、定数定義するぶんにはいくらでも大きな/小さな数値を定義できる。
しかし、変数への代入の際にコンパイルエラーとなる。  
このように、分かりやすさを優先するため、できる限り定数には型を指定したほうが良い。

```go
const (
	N = 9999999999999999999999999999999999999999999999999999999
)
i := N	// コンパイルエラー
```

**NOTE**  
数値定数同士の演算はコンパイル時に処理されるという性質がある。  
そのため、下記のコードは問題なく動作する。

```go
const (
	// uint64型の最大値より1大きな整数値
	N = 18446744073709551615 + 1
)

n := uint64(N - 1)

// コンパイル時に下記の形に変換されて評価されるため、エラーとならない
n := uint64(18446744073709551615)
```

#### 浮動小数点数の定数
浮動小数点数の型(float64, float32)よりも高い精度の少数を定数定義することは可能。  
ただし、float64またはfloat32のどちらかに変換した型が許容するまで精度が落ちる。

**NOTE**  
変数を介さず、定数のみで演算することで、コンパイル時に精度を落とさず演算できる。

#### 複素数の定数
複素数リテラルを使用して定数定義できる。  
複素数の実部・虚部ともに浮動小数点数と同様の精度を備えている。

#### ルーン、文字列の定数
ルーンリテラル、文字列リテラルを使用して、rune型および文字列型の定数を定義できる。  
文字列型定数の定義ではRAW文字列リテラルも使用できる。

### `iota`によるenumのような定数定義
定数定義ブロック内で`iota`キーワードを使用することで、連番の定数を簡単に定義できる。  
ただし、無駄に複雑な定数定義は混乱を招くので、関連の有る単位で定数ブロックを分けること。

- **NOTE**
  - `iota`は0始まり。次の行の定数では+1される。
  - `iota`は省略可能。
  - 異なる値を定義した場合はその値になるが、`iota`自体は行ごとに必ずインクリメントされている。
  - コードブロックごとに`iota`は0にリセットされる。

```go
const (
	A = iota	// 0
	B			// 1
	C			// 2
)

const (
	D = 1 + iota	// 1
	E = 1 + iota	// 2
	F = 1 + iota	// 3
	FF = iota		// 3
)

const (
	G = 1 + iota	// 1
	H				// 1 + iota == 2
	I				// 1 + iota == 3
)

const (
	J = iota	// 0
	K = 100		// 100
	L			// 100
	M = iota	// 4
	N			// 5
)
```

